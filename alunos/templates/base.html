<!DOCTYPE html>
<html lang="pt-br" style="font-family: 'Inter', sans-serif;">
<head>
    <meta charset="UTF-8" />
    <title>{% block title %}Sistema de Alunos{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body class="bg-blue-50 text-gray-800" x-data="{ menuOpen: true }">

<div class="flex h-screen">

    <!-- Menu Lateral -->
    <aside :class="menuOpen ? 'w-56' : 'w-20'" class="bg-blue-800 text-white flex flex-col justify-between transition-all duration-300">
        <div>
            <!-- Cabeçalho com botão de minimizar -->
            <div class="flex items-center justify-between p-4 border-b border-blue-700">
                <span x-show="menuOpen" class="text-lg font-bold text-center transition-all duration-300">GESTOR ACADEMIA JIU-JITSU</span>
                <button @click="menuOpen = !menuOpen" class="text-blue-100 hover:text-white p-1 rounded">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300" :class="menuOpen ? '' : 'rotate-180'" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                </button>
            </div>

            <!-- Autenticação minimalista -->
            <div class="p-4 border-b border-blue-700">
                {% if request.user.is_authenticated %}
                    <div class="flex items-center justify-between" x-show="menuOpen" x-transition>
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-blue-100 font-semibold shadow-inner">
                                {{ request.user.username|slice:":1"|upper }}
                            </div>
                            <div>
                                <p class="text-xs text-blue-200 leading-tight">Bem-vindo,</p>
                                <p class="text-sm font-medium text-white truncate max-w-[120px]">
                                    {{ request.user.get_full_name|default:request.user.username }}
                                </p>
                            </div>
                        </div>
                        <form action="{% url 'logout' %}" method="post" class="inline">
                            {% csrf_token %}
                            <button type="submit" class="p-1 rounded hover:bg-blue-700 text-red-400 hover:text-red-200 transition-colors duration-200" title="Sair">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                        d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6A2.25 2.25 0 005.25 5.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l3 3m0 0l-3 3m3-3H3" />
                                </svg>
                            </button>
                        </form>
                    </div>
                    <div x-show="!menuOpen" class="flex justify-center mt-2" x-transition>
                        <div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-blue-100 font-semibold shadow-inner">
                            {{ request.user.username|slice:":1"|upper }}
                        </div>
                    </div>
                {% else %}
                    <a href="{% url 'login' %}" class="flex items-center justify-center gap-2 px-3 py-1.5 bg-green-600 hover:bg-green-500 rounded-lg text-xs font-medium text-white shadow-sm transition-all duration-200 hover:shadow-md">
                        <span x-show="menuOpen">Faça Login para ter acesso ao Sistema</span>
                        <svg x-show="!menuOpen" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12H3m12 0l-4-4m4 4l-4 4" />
                        </svg>
                    </a>
                {% endif %}
            </div>

            <!-- Navegação -->
            <nav class="mt-4 px-2 space-y-1 text-sm">
                <!-- Dashboard -->
                <a href="{% url 'dashboard' %}" class="flex items-center gap-3 px-4 py-2 rounded hover:bg-blue-700 transition-all duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-100" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3v18h18M7 13v6M12 9v10M17 5v14" />
                    </svg>
                    <span x-show="menuOpen" x-transition>Dashboard</span>
                </a>

                <!-- Alunos -->
                <div x-data="{ open: false }" class="w-full">
                    <button @click="open = !open" class="flex items-center justify-between w-full px-4 py-2 rounded hover:bg-blue-700 focus:outline-none transition-all duration-300">
                        <span class="flex items-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-100" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a4 4 0 00-3-3.87M9 20H4v-2a4 4 0 013-3.87M16 7a4 4 0 11-8 0 4 4 0 018 0z" />
                            </svg>
                            <span x-show="menuOpen">Alunos</span>
                        </span>
                        <svg :class="{'rotate-180': open}" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-100 transform transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div x-show="open && menuOpen" x-transition class="overflow-hidden pl-10 text-blue-200 text-sm flex flex-col gap-1">
                        <a href="{% url 'lista_alunos' %}" class="py-1 hover:text-white transition-all duration-300">Listar Alunos</a>
                        <a href="{% url 'cadastrar_aluno' %}" class="py-1 hover:text-white transition-all duration-300">Cadastrar Aluno</a>
                    </div>
                </div>

                <!-- Gestão -->
                <div x-data="{ open: false }" class="w-full mt-2">
                    <button @click="open = !open" class="flex items-center justify-between w-full px-4 py-2 rounded hover:bg-blue-700 focus:outline-none transition-all duration-300">
                        <span class="flex items-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-100" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7a2 2 0 012-2h5l2 2h7a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z" />
                            </svg>
                            <span x-show="menuOpen">Gestão</span>
                        </span>
                        <svg :class="{'rotate-180': open}" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-100 transform transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div x-show="open && menuOpen" x-transition class="overflow-hidden pl-10 text-blue-200 text-sm flex flex-col gap-1">
                        <a href="{% url 'relatorio_despesas' %}" class="py-1 hover:text-white transition-all duration-300">Visualizar Despesas</a>      
                        <a href="{% url 'relatorio_receber' %}" class="py-1 hover:text-white transition-all duration-300">Valores Recebidos</a>
                        <a href="#" class="py-1 hover:text-white transition-all duration-300">Estoque</a>
                    </div>
                </div>

                <!-- Financeiro -->
                <div x-data="{ open: false }" class="w-full mt-2">
                    <button @click="open = !open" class="flex items-center justify-between w-full px-4 py-2 rounded hover:bg-blue-700 focus:outline-none transition-all duration-300">
                        <span class="flex items-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-100" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-2m0-4h-4m4 0a2 2 0 110 4m0-4v4" />
                            </svg>
                            <span x-show="menuOpen">Financeiro</span>
                        </span>
                        <svg :class="{'rotate-180': open}" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-100 transform transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div x-show="open && menuOpen" x-transition class="overflow-hidden pl-10 text-blue-200 text-sm flex flex-col gap-1">
                        <a href="{% url 'registrar_venda' %}" class="py-1 hover:text-white transition-all duration-300">Registrar Venda</a>
                        <a href="{% url 'registrar_pagamento'%}" class="py-1 hover:text-white transition-all duration-300">Registrar Pagamento</a>
                        <a href="{% url 'registrar_despesa' %}" class="py-1 hover:text-white transition-all duration-300">Registrar Despesas</a> 
                    </div>
                </div>

                <!-- Configurações -->
                <div x-data="{ open: false }" class="w-full mt-2 mb-4">
                    <button @click="open = !open" class="flex items-center justify-between w-full px-4 py-2 rounded hover:bg-blue-700 focus:outline-none transition-all duration-300">
                        <span class="flex items-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-100" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span x-show="menuOpen">Configurações</span>
                        </span>
                        <svg :class="{'rotate-180': open}" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-100 transform transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div x-show="open && menuOpen" x-transition class="overflow-hidden pl-10 text-blue-200 text-sm flex flex-col gap-1">
                        {% if user.is_superuser %}
                            <a href="{% url 'admin:index' %}" class="py-1 hover:text-white transition-all duration-300">Painel Administrador</a>
                        {% else %}
                            <span class="py-1 text-red-400">Usuário sem permissão para acessar o painel</span>
                        {% endif %}
                        
                    </div>
                </div>

            </nav>
        </div>

        <div class="p-4 text-sm text-blue-200 text-center border-t border-blue-700 select-none" x-show="menuOpen" x-transition>
            &copy; {{ year|default:"2025" }} - Sistema Dev Leandro Lopes
        </div>
    </aside>

    <!-- Conteúdo principal -->
    <main class="flex-1 p-6 overflow-y-auto">
        {% block content %}
        {% endblock %}
    </main>

</div>

</body>
</html>
